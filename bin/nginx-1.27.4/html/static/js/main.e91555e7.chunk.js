(this.webpackJsonptrees=this.webpackJsonptrees||[]).push([[0],{16:function(e,t,n){},21:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);n(16);var o=n(4),a=n(11),s=n.n(a),i=n(0),d=n(12),c=n(13),r=n(14),l=n(15);class h{constructor(){const e=(new i.yb).load("assets/imgs/rain.png");this.instance=new i.s;for(let s=0;s<4e3;s++){var t=new i.ub({map:e}),n=new i.tb(t);this.instance.add(n),n.scale.set(1,2,1);var o=Math.random()-.5,a=Math.random()-.5;Math.random();n.position.set(1e3*o,300*Math.random(),1e3*a)}}animate(){this.instance.children.forEach((e=>{e.position.y-=1,e.position.y<0&&(e.position.y=200),e.rotation.y+=.002*Math.random()}))}}const m=(new i.yb).load("assets/imgs/smoke.png"),p=new i.cb(564,300),w=new i.Q({map:m,transparent:!0});class u{constructor(){const e=new i.O(p,w);e.material.opacity=.6,this.instance=e}setPosition(e,t,n){this.instance.position.set(e,t,n)}setRotation(e,t,n){this.instance.rotation.x=e,this.instance.rotation.y=t,this.instance.rotation.z=n}animate(){this.instance.rotation.z-=.003}}let j=null;const b=new d.a;let g;const x=new i.h;let f,O,y,v,M,S,R,C,z,T,k,D,E=[],L=!1,N=!1,F=.01,H=1;const P=[2,10],A=[.75,.9];let I=.5,Q=!0,W=!0,$=25,_=40,B=95,q=3,J=1e4,U=3680024,V=7039494,G=16777215;const K=()=>{y=new i.mb,y.background=new i.i(16777215);!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=new i.t(16777215,16777215,.3);if(o.color=e,o.groundColor.setHSL(.095,1,.75),o.position.set(0,50,0),t.add(o),n){const e=new i.u(o,10);t.add(e)}}((new i.i).setHSL(.6,1,.6),y),function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new i.k(16777215,1);if(n.color.setHSL(.1,1,.95),n.position.set(-1,1.75,1),n.position.multiplyScalar(30),e.add(n),n.castShadow=!0,n.shadow.mapSize.width=2048,n.shadow.mapSize.height=2048,n.shadow.camera.left=-40,n.shadow.camera.right=40,n.shadow.camera.top=40,n.shadow.camera.bottom=-40,t){const t=new i.l(n,10);e.add(t)}}(y);const e=new i.cb(1e3,1e3);z=new i.Q({color:G});const t=new i.O(e,z);t.position.y=-40,t.rotation.x=-Math.PI/2,t.receiveShadow=!0,y.add(t),O=new i.Fb({antialias:1===window.devicePixelRatio,powerPreference:"high-performance"}),O.setSize(window.innerWidth,window.innerHeight),O.setPixelRatio(window.devicePixelRatio),O.outputEncoding=i.Gb,O.shadowMap.enabled=!0,document.body.appendChild(O.domElement),C=new l.a,v=new i.bb(30,.8*window.innerWidth/(.9*window.innerHeight),1,500),v.position.set(0,100,200),S=new c.a(v,O.domElement),R=new r.a(v,O.domElement),y.add(R),R.addEventListener("mouseDown",(function(){S.enabled=!1})),R.addEventListener("mouseUp",(function(){S.enabled=!0})),window.addEventListener("keydown",(function(e){switch(e.key.toUpperCase()){case"R":R.setMode("rotate");break;case"V":R.setMode("translate")}}))};function X(e){H>4?g.traverse((e=>{e instanceof i.s&&(e.name.includes("\u6811\u5e72")?e.rotation.x=i.M.degToRad(oe(-4,4)*F):Math.random()>.6&&(e.rotation.x=i.M.degToRad(oe(-10,10)*F)))})):g.traverse((e=>{if(e instanceof i.s&&1===e.children.length){const t=e.children[0];t instanceof i.s&&Math.random()>.6&&function(e){const t=e.parent,n=i.M.randInt(0,1e4);i.M.seededRandom(n);const o=i.M.degToRad(360*i.M.seededRandom())*F,a=i.M.degToRad(360*i.M.seededRandom())*F,s=Y();t.rotation.x=o+s;const d=Y();t.rotation.z=a+d}(t)}}))}function Y(){return(Math.cos(x.elapsedTime)+1)/2*.001*50}function Z(e,t,n,o){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e/20;const s=.66*a,d=new i.s,c=new i.Db(0,1,0);if(d.position.set(t.x,t.y,t.z),e<q)return te(d),void g.add(d);const r=(new i.i).setHex(U).offsetHSL(0,i.M.seededRandom()/10,i.M.seededRandom()/8),l=((e,t,n,o)=>{const a=new i.j(e,t,n,6,1),s=new i.Q({color:o}),d=new i.O(a,s);return d.receiveShadow=!0,d.castShadow=!0,d})(s,a,e,r);T++,d.add(l),d.name="\u6811\u5e72"+T,g.add(d),l.position.y+=e/2,d.rotation.z=n,c.applyAxisAngle(new i.Db(0,0,1),n),d.rotation.y=o,c.applyAxisAngle(new i.Db(0,1,0),o),c.multiplyScalar(e);const h=t.clone().add(c),m=e===$;if(e>$/3&&!m){const e=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o=new i.qb(e,16,16),a=new i.Q({color:t,transparent:!0,opacity:n}),s=new i.O(o,a);return s.receiveShadow=!0,s.castShadow=!0,s}(1.5*s,r);d.add(e)}else m||(te(d),g.add(d));const p=i.M.seededRandom()<1-I?ne(1,2):ne(3,4);for(let w=0;w<p;w++)n=i.M.degToRad(oe(-B,B)),o=i.M.degToRad(oe(-B,B)),Z(e*i.M.mapLinear(q,P[0],P[1],A[0],A[1]),h,n,o,s)}const ee=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;if(requestAnimationFrame((()=>ee(j))),x.getElapsedTime(),X(),!Q){const e=200;v.position.x=f.position.x+e*Math.cos(.4*x.elapsedTime),v.position.z=f.position.z+e*Math.sin(.4*x.elapsedTime),v.position.y=90+(f.position.y+35*Math.sin(.2*x.elapsedTime)),v.lookAt(f.position)}var t,n;if(e)if("0"==e);else if(j=e,console.log(`${(null===e||void 0===e||null===(t=e.weather)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.main)||"No data"}`),e.weather[0].main.toLowerCase().includes("rain"))L||(L=!0,k=new h,k.instance.name="rain",y.add(k.instance)),function(){if(!N){N=!0;for(let e=0;e<10;e++)D=new u,E.push(D),D.setPosition(10*Math.random()+10,20*Math.random()+60,10*-Math.random()-2),D.setRotation(1.2,-.32,360*Math.random()),D.instance.name=e.toString(),y.add(D.instance)}}(),k&&(k.animate(),E.forEach((e=>{e.animate()})));else{L=!1,N=!1,y.remove(y.getObjectByName("rain"));for(var o=0;o<10;o++)y.remove(y.getObjectByName(o.toString()))}S.update(),C.update(),O.render(y,v)};function te(e){const t=_*i.M.seededRandom(),n=i.M.degToRad(360*i.M.seededRandom()),o=i.M.degToRad(360*i.M.seededRandom()),a=(new i.i).setHex(V).offsetHSL(i.M.seededRandom()/10,i.M.seededRandom()/10,i.M.seededRandom()/8);if(!W)return;const s=M.clone();s.rotation.setFromVector3(new i.Db(0,0,0));const d=(new i.c).setFromObject(s),c=d.getCenter(new i.Db),r=d.getSize(new i.Db);s.scale.set(t,t,t),d.setFromObject(s),d.getCenter(c),d.getSize(r),(new i.c).setFromObject(s).getCenter(s.position),s.position.add(new i.Db(0,0,r.z/2)),s.position.multiplyScalar(-1),s.position.copy(c).multiplyScalar(-1);let l=new i.s;l.add(s),s.position.z-=.45*r.z,s.position.x+=.0075*r.x,s.position.y+=.01*r.y,l.rotation.x=n,l.rotation.z=o,s.traverse((function(e){if(e){var t=new i.Q({color:a});e.material=t,e.castShadow=!0,e.receiveShadow=!0}})),e.add(l)}function ne(e,t){return Math.floor(i.M.seededRandom()*(t-e+1)+e)}function oe(e,t){return i.M.seededRandom()*(t-e)+e}var ae=n(31),se=(n(21),n(3));var ie=()=>{const[e,t]=Object(o.useState)(null),[n,a]=Object(o.useState)(!0),[s,i]=Object(o.useState)(null),[d,c]=Object(o.useState)(null),[r,l]=Object(o.useState)(39.9042),[h,m]=Object(o.useState)(116.4074),p={shanghai:{lat:31.2304,lon:121.4737},"\u7ebd\u7ea6":{lat:74,lon:40.43},dongying:{lat:37.4343,lon:118.6857},haidian:{lat:39.957,lon:116.3075}},w=e=>(e-273.15).toFixed(2);Object(o.useEffect)((()=>{(async()=>{try{const e=await ae.a.get(`https://api.openweathermap.org/data/2.5/weather?lat=${r}&lon=${h}&appid=7749ab343a0f2c1e02c676ee8ac2f822`),n=e.data.wind.speed;(async e=>{e>=0&&e<1?(F=.01,H=1):e>=1&&e<2?(H=2,F=.05):e>=2&&e<3?(H=3,F=.09):e>=3&&e<4?(H=4,F=.2):e>=4&&e<5?(H=5,F=.5):(H=5,F=.4)})(n);const o=u(n);c(o),t(e.data),ee(e.data),a(!1)}catch(s){i(s),a(!1)}})()}),[r,h]);const u=e=>e>=0&&e<.6?"1\u7ea7\uff1a\u8f7b\u98ce":e>=.6&&e<1.6?"2\u7ea7\uff1a\u548c\u98ce":e>=1.6&&e<3.4?"3\u7ea7\uff1a\u5fae\u98ce":e>=3.4&&e<5.5?"4\u7ea7\uff1a\u6e05\u98ce":e>=5.5&&e<8?"5\u7ea7\uff1a\u5f3a\u98ce":e>=8&&e<10.8?"6\u7ea7\uff1a\u52b2\u98ce":e>=10.8&&e<13.9?"7\u7ea7\uff1a\u75be\u98ce":e>=13.9&&e<17.2?"8\u7ea7\uff1a\u5927\u98ce":e>=17.2&&e<20.8?"9\u7ea7\uff1a\u70c8\u98ce":e>=20.8&&e<24.5?"10\u7ea7\uff1a\u66b4\u98ce":"11\u7ea7\uff1a\u72c2\u98ce",j=e=>{l(p[e].lat),m(p[e].lon)};return n?Object(se.jsx)("div",{children:"Loading..."}):s?Object(se.jsxs)("div",{children:["Error occurred: ",s.message]}):Object(se.jsxs)("div",{className:"weather-container",children:[Object(se.jsxs)("h3",{children:["\u56fd\u5bb6 ",e.sys.country," ",e.name]}),Object(se.jsxs)("p",{children:["\u5929\u6c14:",e.weather[0].description+" ","\u98ce\u529b: ",d," "]}),Object(se.jsxs)("p",{children:["\u6e29\u5ea6: ",w(e.main.temp)," \xb0C \u4f53\u611f: ",w(e.main.feels_like)," \xb0C  "]}),Object(se.jsxs)("p",{children:["\u6e7f\u5ea6: ",e.main.humidity,"%"]}),Object(se.jsxs)("div",{className:"city-selector",children:[Object(se.jsx)("button",{onClick:()=>j("shanghai"),children:"\u4e0a\u6d77"}),Object(se.jsx)("button",{onClick:()=>j("\u7ebd\u7ea6"),children:"\u7ebd\u7ea6"}),Object(se.jsx)("button",{onClick:()=>j("dongying"),children:"\u4e1c\u8425"}),Object(se.jsx)("button",{onClick:()=>j("haidian"),children:"\u6d77\u6dc0"})]}),Object(se.jsxs)("div",{className:"coordinates-input",children:[Object(se.jsxs)("label",{children:["\u7ecf\u5ea6:",Object(se.jsx)("input",{type:"number",value:h,onChange:e=>m(parseFloat(e.target.value))})]}),Object(se.jsxs)("label",{children:["\u7eac\u5ea6:",Object(se.jsx)("input",{type:"number",value:r,onChange:e=>l(parseFloat(e.target.value))})]})]}),Object(se.jsx)("h2",{children:"Weather Information"}),Object(se.jsxs)("p",{id:"weatherid",children:["Weather: ",e.weather[0].main," -"," ",e.weather[0].description]}),Object(se.jsxs)("p",{children:["\u6e29\u5ea6: ",w(e.main.temp)," \xb0C"]}),Object(se.jsxs)("p",{children:["\u4f53\u611f\u6e29\u5ea6: ",w(e.main.feels_like)," \xb0C "]}),Object(se.jsxs)("p",{children:["\u6700\u4f4e\u6e29\u5ea6: ",w(e.main.temp_min),"  \xb0C"]}),Object(se.jsxs)("p",{children:["\u6700\u9ad8\u6e29\u5ea6: ",w(e.main.temp_max),"  \xb0C"]}),Object(se.jsxs)("p",{children:["Pressure: ",e.main.pressure," hPa"]}),Object(se.jsxs)("p",{children:["\u6e7f\u5ea6: ",e.main.humidity,"%"]}),Object(se.jsxs)("p",{children:["\u53ef\u89c1\u5ea6: ",e.visibility," \u7c73"]}),Object(se.jsxs)("p",{children:["\u98ce\u901f: ",e.wind.speed," m/s, \u98ce\u5411:"," ",(b=e.wind.deg,["\u5317\u98ce (North)","\u4e1c\u5317\u98ce (Northeast)","\u4e1c\u98ce (East)","\u4e1c\u5357\u98ce (Southeast)","\u5357\u98ce (South)","\u897f\u5357\u98ce (Southwest)","\u897f\u98ce (West)","\u897f\u5317\u98ce (Northwest)"][Math.round(b/45)%8]||"\u672a\u77e5\u65b9\u5411"),e.wind.deg,"\xb0, \u9635\u98ce: ",e.wind.gust?`${e.wind.gust} m/s`:"\u65e0"]}),Object(se.jsxs)("p",{children:["\u4e91\u91cf: ",e.clouds.all,"%"]}),Object(se.jsxs)("p",{children:["Date/Time: ",new Date(1e3*e.dt).toLocaleString()]}),Object(se.jsxs)("p",{children:["Country: ",e.sys.country]}),Object(se.jsxs)("p",{children:["\u65e5\u51fa: ",new Date(1e3*e.sys.sunrise).toLocaleTimeString()]}),Object(se.jsxs)("p",{children:["\u65e5\u843d: ",new Date(1e3*e.sys.sunset).toLocaleTimeString()]}),Object(se.jsxs)("p",{children:["Timezone: ",e.timezone]}),Object(se.jsxs)("p",{children:["City ID: ",e.id]}),Object(se.jsxs)("p",{children:["City Name: ",e.name]})]});var b};const de=()=>Object(se.jsxs)("div",{children:[Object(se.jsx)(ie,{}),Object(se.jsx)("div",{id:"app"})]});s.a.render(Object(se.jsx)(de,{}),document.getElementById("root")),(async()=>{const e=await b.loadAsync("assets/leaf/scene.gltf");M=e.scene.clone(),M.name="leaf",M.castShadow=!0,M.receiveShadow=!0,K(),i.M.seededRandom(J),y.remove(g),g=new i.s,Z($,new i.Db(0,0,0),0,0,$/10),y.add(g),g.position.set(0,-40,0),ee("0")})()}},[[29,1,2]]]);
//# sourceMappingURL=main.e91555e7.chunk.js.map